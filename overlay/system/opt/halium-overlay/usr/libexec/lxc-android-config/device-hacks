# While the time_daemon binary has been overlayed by a non-executable, Android
# init will continue trying to restart that service. Stop the cycle by
# explicitly tell it to stop.
setprop ctl.stop time_daemon

# hide fuelgauge and sec-direct-charger
mount -o ro -t tmpfs tmpfs /sys/class/power_supply/s2asl01-limiter-main
mount -o ro -t tmpfs tmpfs /sys/class/power_supply/s2asl01-limiter-sub
mount -o ro -t tmpfs tmpfs /sys/class/power_supply/sec-dual-battery

# HACK: hide outer panel backlight sysfs
mount -o ro -t tmpfs tmpfs /sys/class/backlight/panel
mount -o ro -t tmpfs tmpfs /sys/class/backlight/panel1
mount -o ro -t tmpfs tmpfs /sys/class/backlight/panel1-backlight

# WiFi: Wait for the property system to be up.
while [ ! -e /dev/socket/property_service ]; do sleep 0.2; done
while [ "$(getprop init.svc.vendor.wifi_hal_legacy)" != "running" ]; do sleep 0.2; done
echo 1 > /dev/ipa

while [ ! -e /dev/wlan ]; do sleep 1; done
echo ON > /dev/wlan; sleep 6

# Bluetooth bringup
systemctl restart bluetooth
